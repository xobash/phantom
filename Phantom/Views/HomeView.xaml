<UserControl x:Class="Phantom.Views.HomeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Background="{DynamicResource AppBgBrush}">
    <Grid Background="{DynamicResource AppBgBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Margin="4">
            <TextBlock Text="Home Dashboard" FontSize="22" FontWeight="SemiBold" VerticalAlignment="Center" Margin="4,0,12,0"/>
            <Button Margin="4"
                    Command="{Binding RefreshCommand}"
                    Style="{StaticResource RefreshIconButtonStyle}"
                    ToolTip="Refresh home snapshot"/>
        </StackPanel>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <ItemsControl ItemsSource="{Binding TopCards}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Columns="2"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource DarkCardStyle}"
                                    ToolTip="{Binding Tooltip}"
                                    Cursor="Hand"
                                    Tag="{Binding Title}"
                                    MouseLeftButtonUp="Card_MouseLeftButtonUp">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <DockPanel Grid.Row="0" LastChildFill="False">
                                        <Button DockPanel.Dock="Right"
                                                Width="32"
                                                Height="32"
                                                Padding="0"
                                                Margin="8,0,0,0"
                                                Command="{Binding DataContext.RunWinsatCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                ToolTip="Run Windows Experience Index benchmark (WinSAT)">
                                            <Button.Style>
                                                <Style TargetType="Button" BasedOn="{StaticResource DarkButtonStyle}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Title}" Value="Performance">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                            <Viewbox Width="16" Height="16" Stretch="Uniform">
                                                <Path Stroke="{DynamicResource DarkTextBrush}"
                                                      StrokeThickness="1.8"
                                                      Fill="Transparent"
                                                      StrokeStartLineCap="Round"
                                                      StrokeEndLineCap="Round"
                                                      StrokeLineJoin="Round"
                                                      Data="M12,2 C8.8,5.3 7.8,8.1 7.8,10.5 C7.8,13.4 9.8,15.5 12.3,15.5 C14.8,15.5 16.8,13.4 16.8,10.5 C16.8,8.2 15.6,5.4 12,2 Z M12.3,8.1 C11.1,9.3 10.8,10.3 10.8,11.3 C10.8,12.4 11.6,13.2 12.3,13.2 C13,13.2 13.8,12.4 13.8,11.3 C13.8,10.3 13.5,9.3 12.3,8.1 Z"/>
                                            </Viewbox>
                                        </Button>
                                        <TextBlock Text="{Binding Title}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    </DockPanel>
                                    <TextBlock Grid.Row="1" Text="{Binding Value}" Margin="0,6,0,0" TextWrapping="Wrap"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <ItemsControl ItemsSource="{Binding KpiTiles}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Columns="4"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource DarkCardStyle}"
                                    Cursor="Hand"
                                    Tag="{Binding Title}"
                                    MouseLeftButtonUp="Card_MouseLeftButtonUp">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock x:Name="KpiTitle" Text="{Binding Title}" FontSize="14" Opacity="0.75"/>
                                    <TextBlock x:Name="KpiValue" Grid.Row="1" Text="{Binding Value}" FontSize="20" FontWeight="SemiBold" Margin="0,6,0,0">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
                                                <Setter Property="FontSize" Value="20"/>
                                                <Setter Property="LineHeight" Value="24"/>
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                                <Setter Property="Foreground" Value="{DynamicResource DarkTextBrush}"/>
                                                <Setter Property="TextWrapping" Value="Wrap"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Title}" Value="Network">
                                                        <Setter Property="FontSize" Value="12"/>
                                                        <Setter Property="LineHeight" Value="16"/>
                                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                                        <Setter Property="TextAlignment" Value="Right"/>
                                                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                                                        <Setter Property="TextWrapping" Value="NoWrap"/>
                                                        <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock x:Name="KpiSecondary"
                                               Grid.Row="2"
                                               Text="{Binding SecondaryValue}"
                                               FontSize="32"
                                               FontWeight="SemiBold"
                                               Margin="0,8,0,0"
                                               HorizontalAlignment="Right"
                                               Visibility="Collapsed"
                                               Foreground="{DynamicResource DarkTextBrush}">
                                        <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Setter Property="FontSize" Value="30"/>
                                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                                </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
